
<!DOCTYPE html>
<html>
<head>
    <title>Relatório EDI por Pedido (2026-01-29)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f6f9; margin: 0; padding: 20px; }
        .header { text-align: center; margin-bottom: 30px; }
        .summary-card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); display: flex; justify-content: center; align-items: center; max-width: 900px; margin: 0 auto 30px auto; gap: 50px; }
        .chart-container-doughnut { width: 250px; height: 250px; }
        .metrics-container { display: flex; flex-direction: column; justify-content: center; gap: 15px; text-align: left; }
        .metric-row { font-size: 16px; color: #555; }
        .metric-value { font-weight: bold; font-size: 20px; }
        .metric-large { font-size: 24px; font-weight: bold; border-top: 1px solid #eee; padding-top: 10px; margin-top: 5px; }
        .group-container { max-width: 1000px; margin: 0 auto; }
        .group-card { background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); margin-bottom: 15px; overflow: hidden; }
        .group-header { padding: 20px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; border-left: 5px solid #ddd; transition: background 0.2s; }
        .group-header:hover { background-color: #f9f9f9; }
        .group-header.has-error { border-left-color: #FF6384; }
        .group-header.all-success { border-left-color: #4BC0C0; }
        .group-info h3 { margin: 0 0 5px 0; font-size: 18px; }
        .group-stats { font-size: 14px; color: #555; }
        .toggle-icon { font-size: 20px; color: #999; transition: transform 0.3s; }
        .group-card.active .toggle-icon { transform: rotate(180deg); }
        .group-content { display: none; padding: 20px; border-top: 1px solid #eee; background-color: #fafafa; position: relative; }
        .group-card.active .group-content { display: block; }
        .chart-wrapper { position: relative; height: 400px; width: 100%; }
        .btn-load { background-color: #36A2EB; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin-top: 10px; }
        .error-detail-tooltip { position: absolute; background: rgba(0, 0, 0, 0.85); color: white; padding: 10px; border-radius: 4px; font-size: 12px; pointer-events: none; z-index: 100; max-width: 300px; display: none; }
        .error-detail-header { font-weight: bold; margin-bottom: 5px; border-bottom: 1px solid #555; padding-bottom: 3px; }
        .error-item { display: flex; justify-content: space-between; margin-bottom: 2px; }
        .error-count { font-weight: bold; color: #FF6384; margin-right: 10px; }
        .legend-corrected { color: #2ecc71; font-weight: bold; }
    </style>
</head>
<body>
    <div class="header"><h1>Relatório EDI por Pedido (2026-01-29)</h1></div>
    <div class="summary-card">
        <div class="chart-container-doughnut"><canvas id="doughnutChart"></canvas></div>
        <div class="metrics-container">
            <div class="metric-row">Total de Pedidos Únicos: <span class="metric-value">109</span></div>
            <div class="metric-row">Sucessos: <span class="metric-value" style="color: #4BC0C0;">0</span></div>
            <div class="metric-row">Erros Únicos: <span class="metric-value" style="color: #FF6384;">109</span></div>
            <div class="metric-large">Taxa de Sucesso: 0.00%</div>
        </div>
    </div>
    <div class="group-container" id="groupsContainer"></div>
    <div id="customTooltip" class="error-detail-tooltip"></div>
    <script>
        const groupsData = [{"groupName": "Outros (API)", "totalSuccess": 0, "totalError": 50, "entries": [{"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 177712", "success": 0, "error": 4, "isCorrected": false, "error_types": {"Registro do cliente n\u00e3o encontrado": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 177714", "success": 0, "error": 4, "isCorrected": false, "error_types": {"Registro do cliente n\u00e3o encontrado": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 177713", "success": 0, "error": 4, "isCorrected": false, "error_types": {"Registro do cliente n\u00e3o encontrado": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104780", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104784", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104768", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104782", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104788", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104764", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104766", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104798", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104786", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104762", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104774", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104760", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104776", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104770", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104790", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104778", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104792", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104772", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104794", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 104796", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084979", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 085007", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 085003", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084963", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084975", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084997", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084985", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084977", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084973", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084971", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084991", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084969", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084999", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 085001", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084961", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084967", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084989", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084955", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084987", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084983", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 085005", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084981", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084993", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084957", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084965", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084995", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[API] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 084959", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}]}, {"groupName": "ATACADAO RJ", "totalSuccess": 0, "totalError": 28, "entries": [{"label": "[C001826] ATACADAO S.A. - Pedido: 104781", "success": 0, "error": 4, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 4}}, {"label": "[C002835] ATACADAO S.A. - Pedido: 084978", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C008347] WMS SUPERMERCADOS DO BRASIL LTDA - Pedido: 085002", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C011754] ATACADAO S.A. - Pedido: 084962", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C001826] ATACADAO S.A. - Pedido: 084976", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C008742] WMS SUPERMERCADOS DO BRASIL LTDA - Pedido: 085006", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C005503] ATACADAO S.A. - Pedido: 084998", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C001797] ATACADAO S.A. - Pedido: 084974", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C016001] ATACADAO S.A. - Pedido: 084970", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C002914] ATACADAO S.A. - Pedido: 084980", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C008504] WMS SUPERMERCADOS DO BRASIL LTDA - Pedido: 085000", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C003507] ATACADAO S.A. - Pedido: 084982", "success": 0, "error": 3, "isCorrected": false, "error_types": {"Request failed with status code 502": 1, "N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C009977] ATACADAO S.A. - Pedido: 084960", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C011755] ATACADAO S.A. - Pedido: 084964", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C004017] WMS SUPERMERCADOS DO BRASIL LTDA - Pedido: 085008", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C004397] ATACADAO S.A. - Pedido: 084996", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C001117] ATACADAO S.A. - Pedido: 084972", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C009081] WMS SUPERMERCADOS DO BRASIL LTDA - Pedido: 085004", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C003634] ATACADAO S.A. - Pedido: 084988", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C013426] ATACADAO S.A. - Pedido: 084966", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C003776] ATACADAO S.A. - Pedido: 084984", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C003633] ATACADAO S.A. - Pedido: 084990", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C009512] ATACADAO S.A. - Pedido: 084956", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C003635] ATACADAO S.A. - Pedido: 084986", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C014480] ATACADAO S.A. - Pedido: 084968", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C003631] ATACADAO S.A. - Pedido: 084992", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C009510] ATACADAO S.A. - Pedido: 084958", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C003782] ATACADAO S.A. - Pedido: 084994", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}]}, {"groupName": "ZARAGOZA", "totalSuccess": 0, "totalError": 14, "entries": [{"label": "[C004786] COMERCIAL ZARAGOZA IMPORTACAO E EXPORTACAO LIMITADA - Pedido: 67061", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C004156] COMERCIAL ZARAGOZA IMPORTACAO E EXPORTACAO LIMITADA - Pedido: 67062", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C012419] COMERCIAL ZARAGOZA IMPORTACAO E EXPORTACAO LIMITADA - Pedido: 67065", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C016199] COMERCIAL ZARAGOZA IMPORTACAO E EXPORTACAO LIMITADA - Pedido: 67067", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C000131] COMERCIAL ZARAGOZA IMPORTACAO E EXPORTACAO LIMITADA - Pedido: 67069", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C013562] COMERCIAL ZARAGOZA IMPORTACAO E EXPORTACAO LIMITADA - Pedido: 67066", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C004786] COMERCIAL ZARAGOZA IMPORTACAO E EXPORTACAO LIMITADA - Pedido: 132750", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C013010] COMERCIAL ZARAGOZA IMPORTACAO E EXPORTACAO LIMITADA - Pedido: 132753", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C012419] COMERCIAL ZARAGOZA IMPORTACAO E EXPORTACAO LIMITADA - Pedido: 132754", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C013562] COMERCIAL ZARAGOZA IMPORTACAO E EXPORTACAO LIMITADA - Pedido: 132755", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C016199] COMERCIAL ZARAGOZA IMPORTACAO E EXPORTACAO LIMITADA - Pedido: 132756", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C000131] COMERCIAL ZARAGOZA IMPORTACAO E EXPORTACAO LIMITADA - Pedido: 132758", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C004786] COMERCIAL ZARAGOZA IMPORTACAO E EXPORTACAO LIMITADA - Pedido: 207698", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C016199] COMERCIAL ZARAGOZA IMPORTACAO E EXPORTACAO LIMITADA - Pedido: 207704", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}]}, {"groupName": "NAGUMO", "totalSuccess": 0, "totalError": 9, "entries": [{"label": "[C000062] MIXTER ATACADO E VAREJO DE GENEROS ALIMENTICIOS LTDA - Pedido: 7724959", "success": 0, "error": 2, "isCorrected": false, "error_types": {"(-1) N\u00e3o \u00e9 poss\u00edvel adicionar a Cota\u00e7\u00e3o. Entrar em contato c..": 2}}, {"label": "[C000062] MIXTER ATACADO E VAREJO DE GENEROS ALIMENTICIOS LTDA - Pedido: 7666404", "success": 0, "error": 2, "isCorrected": false, "error_types": {"[OQUT.DocTotalSy] , Per\u00edodo de lan\u00e7amento bloqueado; especif..": 2}}, {"label": "[C009068] ESTOK BRASIL COMERCIO DE ALIMENTOS LTDA - Pedido: 7744441", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C002548] MERCANTIL VISTA VERDE LTDA - Pedido: 7744523", "success": 0, "error": 2, "isCorrected": false, "error_types": {"O valor na Quantidade n\u00e3o pode ser zero  [DocumentLines.Quan..": 2}}, {"label": "[C002548] MERCANTIL VISTA VERDE LTDA - Pedido: 7830387", "success": 0, "error": 2, "isCorrected": false, "error_types": {"O valor na Quantidade n\u00e3o pode ser zero  [DocumentLines.Quan..": 2}}, {"label": "[C002548] MERCANTIL VISTA VERDE LTDA - Pedido: 7830513", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C008763] COMERCIAL BRASIL DE ATIBAIA LTDA - Pedido: 7830513", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C000062] MIXTER ATACADO E VAREJO DE GENEROS ALIMENTICIOS LTDA - Pedido: 7830513", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C002322] COMERCIAL BARATAO COLONIAL LTDA - Pedido: 7830513", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}]}, {"groupName": "CARREFOUR SP", "totalSuccess": 0, "totalError": 7, "entries": [{"label": "[C002212] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 000189440482064", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C003612] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 000328450628569", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C003612] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 000328480730778", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C003612] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 000328010980242", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C005702] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 000105010071263", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C000065] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 000129010111349", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}, {"label": "[C005704] CARREFOUR COMERCIO E INDUSTRIA LTDA - Pedido: 000125010167809", "success": 0, "error": 2, "isCorrected": false, "error_types": {"N\u00famero de item n\u00e3o informado; especifique um n\u00famero de item ..": 2}}]}, {"groupName": "N\u00e3o Identificado", "totalSuccess": 0, "totalError": 1, "entries": [{"label": "[S/C] Desconhecido - Pedido: N/A", "success": 0, "error": 142, "isCorrected": false, "error_types": {"Pedido 6002898782 j\u00e1 cadastrado no SAP": 2, "Pedido 177709 j\u00e1 cadastrado no SAP": 2, "Pedido 177711 j\u00e1 cadastrado no SAP": 2, "Pedido 132751 j\u00e1 cadastrado no SAP": 2, "Pedido 6002924838 j\u00e1 cadastrado no SAP": 2, "Pedido 6002924837 j\u00e1 cadastrado no SAP": 2, "Pedido 6002924834 j\u00e1 cadastrado no SAP": 2, "Pedido 177710 j\u00e1 cadastrado no SAP": 2, "Pedido 6002908737 j\u00e1 cadastrado no SAP": 2, "Pedido 6002908731 j\u00e1 cadastrado no SAP": 2, "Pedido 6002908729 j\u00e1 cadastrado no SAP": 2, "Pedido 6002908728 j\u00e1 cadastrado no SAP": 2, "Pedido 6002908726 j\u00e1 cadastrado no SAP": 2, "Pedido 207699 j\u00e1 cadastrado no SAP": 2, "Pedido 207702 j\u00e1 cadastrado no SAP": 2, "Pedido 207703 j\u00e1 cadastrado no SAP": 2, "Pedido 207701 j\u00e1 cadastrado no SAP": 2, "Pedido 207706 j\u00e1 cadastrado no SAP": 2, "Pedido 104783 j\u00e1 cadastrado no SAP": 4, "Pedido 104785 j\u00e1 cadastrado no SAP": 4, "Pedido 104787 j\u00e1 cadastrado no SAP": 4, "Pedido 104795 j\u00e1 cadastrado no SAP": 4, "Pedido 104767 j\u00e1 cadastrado no SAP": 4, "Pedido 104769 j\u00e1 cadastrado no SAP": 4, "Pedido 104789 j\u00e1 cadastrado no SAP": 4, "Pedido 104765 j\u00e1 cadastrado no SAP": 4, "Pedido 104797 j\u00e1 cadastrado no SAP": 4, "Pedido 104773 j\u00e1 cadastrado no SAP": 4, "Pedido 104763 j\u00e1 cadastrado no SAP": 4, "Pedido 104775 j\u00e1 cadastrado no SAP": 4, "Pedido 104761 j\u00e1 cadastrado no SAP": 4, "Pedido 104779 j\u00e1 cadastrado no SAP": 4, "Pedido 104777 j\u00e1 cadastrado no SAP": 4, "Pedido 104799 j\u00e1 cadastrado no SAP": 4, "Pedido 104771 j\u00e1 cadastrado no SAP": 4, "Pedido 104791 j\u00e1 cadastrado no SAP": 4, "Pedido 104793 j\u00e1 cadastrado no SAP": 4, "Pedido 6002968887 j\u00e1 cadastrado no SAP": 2, "Pedido 6002968882 j\u00e1 cadastrado no SAP": 2, "Pedido 6002968880 j\u00e1 cadastrado no SAP": 2, "Pedido 6002968879 j\u00e1 cadastrado no SAP": 2, "Pedido 6002968878 j\u00e1 cadastrado no SAP": 2, "Pedido 4507914613 j\u00e1 cadastrado no SAP": 2, "Pedido 347555 j\u00e1 cadastrado no SAP": 2, "Pedido 347556 j\u00e1 cadastrado no SAP": 2, "Pedido 347553 j\u00e1 cadastrado no SAP": 2, "Pedido 347554 j\u00e1 cadastrado no SAP": 2, "Pedido 347561 j\u00e1 cadastrado no SAP": 2, "Pedido 347557 j\u00e1 cadastrado no SAP": 2, "Pedido 347560 j\u00e1 cadastrado no SAP": 2, "Pedido 347558 j\u00e1 cadastrado no SAP": 2, "Pedido 347559 j\u00e1 cadastrado no SAP": 2}}]}];
        const PAGE_SIZE = 10;
        
        new Chart(document.getElementById('doughnutChart').getContext('2d'), {
            type: 'doughnut',
            data: {
                labels: ['Sucesso', 'Erros'],
                datasets: [{ data: [0,109], backgroundColor: ['#4BC0C0', '#FF6384'] }]
            },
            options: { responsive: true, maintainAspectRatio: false }
        });

        const container = document.getElementById('groupsContainer');
        groupsData.forEach((grp, index) => {
            const card = document.createElement('div');
            card.className = 'group-card';
            const borderClass = grp.totalError > 0 ? 'has-error' : 'all-success';
            card.innerHTML = `
                <div class="group-header ${borderClass}" onclick="toggleGroup(${index})">
                    <div class="group-info">
                        <h3>${grp.groupName}</h3>
                        <div class="group-stats">Sucesso: <b>${grp.totalSuccess}</b> | Erros: <b>${grp.totalError}</b></div>
                    </div>
                    <div class="toggle-icon">▼</div>
                </div>
                <div class="group-content" id="content-${index}">
                    <div class="chart-wrapper"><canvas id="chart-${index}"></canvas></div>
                    <button class="btn-load" id="btn-${index}" onclick="loadMore(${index})">Carregar Mais</button>
                </div>
            `;
            container.appendChild(card);
            grp.visualIndex = 0;
            grp.chartInstance = null;
        });

        function toggleGroup(i) {
            const content = document.getElementById(`content-${i}`);
            if (content.style.display === 'block') {
                content.style.display = 'none';
                content.parentElement.classList.remove('active');
            } else {
                content.style.display = 'block';
                content.parentElement.classList.add('active');
                if (!groupsData[i].chartInstance) {
                    initChart(i);
                    loadMore(i);
                }
            }
        }

        function initChart(i) {
            const ctx = document.getElementById(`chart-${i}`).getContext('2d');
            groupsData[i].chartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [
                        { label: 'Sucesso', data: [], backgroundColor: '#4BC0C0' },
                        { label: 'Erro', data: [], backgroundColor: '#FF6384' },
                        { label: 'Corrigido', data: [], backgroundColor: '#2ecc71' }
                    ]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    layout: { padding: { left: 20 } },
                    scales: { 
                        x: { stacked: true }, 
                        y: { 
                            stacked: true,
                            ticks: {
                                font: { size: 10 },
                                callback: function(value) {
                                    const label = this.getLabelForValue(value);
                                    if (label.length > 45) {
                                        const parts = label.split(' - Pedido: ');
                                        const prefix = parts[0];
                                        const order = parts.length > 1 ? ' - Ped: ' + parts[1] : '';
                                        const codeMatch = prefix.match(/^(\[.*?\])/);
                                        const code = codeMatch ? codeMatch[1] : "";
                                        const name = prefix.replace(code, "").trim();
                                        if (name.length > 20) {
                                            return code + " " + name.substring(0, 17) + "..." + order;
                                        }
                                    }
                                    return label;
                                }
                            }
                        } 
                    },
                    plugins: { 
                        legend: { display: true, position: 'top' },
                        tooltip: { 
                            enabled: false,
                            external: function(context) {
                                const el = document.getElementById('customTooltip');
                                if (context.tooltip.opacity === 0) { el.style.display = 'none'; return; }
                                
                                const entry = groupsData[i].entries[context.tooltip.dataPoints[0].dataIndex];
                                let html = `<div class="error-detail-header">${entry.label}</div>`;
                                
                                if (entry.isCorrected) {
                                    html += `<div style="color: #2ecc71; font-weight: bold; margin-bottom:5px;">ERRO CORRIGIDO COM SUCESSO!</div>`;
                                }

                                if (Object.keys(entry.error_types).length > 0) {
                                    html += `<div style="font-weight:bold; margin-top:5px;">Erros Identificados:</div>`;
                                    for (const [m, c] of Object.entries(entry.error_types)) {
                                        html += `<div class="error-item"><span>${m}</span><b>${c}</b></div>`;
                                    }
                                }
                                
                                if (entry.success > 0) {
                                    html += `<div style="margin-top:5px; color:#4BC0C0;">Status Final: SUCESSO</div>`;
                                }

                                el.innerHTML = html;
                                el.style.display = 'block';
                                const position = context.chart.canvas.getBoundingClientRect();
                                el.style.left = position.left + window.pageXOffset + context.tooltip.caretX + 20 + 'px';
                                el.style.top = position.top + window.pageYOffset + context.tooltip.caretY + 'px';
                            }
                        }
                    }
                }
            });
        }

        function loadMore(i) {
            const g = groupsData[i];
            const batch = g.entries.slice(g.visualIndex, g.visualIndex + PAGE_SIZE);
            if (batch.length === 0) return;

            batch.forEach(entry => {
                g.chartInstance.data.labels.push(entry.label);
                
                if (entry.isCorrected) {
                    // Show small Red part and bigger Green part
                    g.chartInstance.data.datasets[1].data.push(0.3); // Micro erro
                    g.chartInstance.data.datasets[2].data.push(0.7); // Sucesso Corrigido
                    g.chartInstance.data.datasets[0].data.push(0);
                } else if (entry.error > 0) {
                    g.chartInstance.data.datasets[1].data.push(1);
                    g.chartInstance.data.datasets[0].data.push(0);
                    g.chartInstance.data.datasets[2].data.push(0);
                } else {
                    g.chartInstance.data.datasets[0].data.push(1);
                    g.chartInstance.data.datasets[1].data.push(0);
                    g.chartInstance.data.datasets[2].data.push(0);
                }
            });
            
            g.visualIndex += batch.length;
            g.chartInstance.update();
            if (g.visualIndex >= g.entries.length) document.getElementById(`btn-${i}`).style.display = 'none';
        }
    </script>
</body>
</html>
